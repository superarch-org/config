#!/bin/bash

# Prompt for URL with rofi
input=$(echo "" | rofi -dmenu -i -p "URL")

# Exit if no input entered
[ -z "$input" ] && exit 0

# Handle shortcuts
case "$input" in
  gh:*)
    # gh:user/repo -> github.com/user/repo
    repo="${input#gh:}"
    url="https://github.com/$repo"
    ;;
  g:*)
    # g:search term -> Google search
    query="${input#g:}"
    url="https://www.google.com/search?q=$(echo "$query" | sed 's/ /+/g')"
    ;;
  dd:*)
    # dd:search term -> DuckDuckGo search
    query="${input#dd:}"
    url="https://duckduckgo.com/?q=$(echo "$query" | sed 's/ /+/g')"
    ;;
  yt:*)
    # yt:search -> YouTube search
    query="${input#yt:}"
    url="https://www.youtube.com/results?search_query=$(echo "$query" | sed 's/ /+/g')"
    ;;
  *)
    # Regular URL handling
    url="$input"
    if ! echo "$url" | grep -q "://"; then
      url="http://$url"
    fi
    ;;
esac

# Create temporary directory that gets auto-deleted
tmpdir=$(mktemp -d)

# Launch Brave with temp profile
brave --user-data-dir="$tmpdir" --incognito "$url"

# Clean up after Brave closes
rm -rf "$tmpdir"
